# Agentic-IAM Authentication Flow

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Agentic-IAM Application                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Browser   â”‚â”€â”€â”€â”€ HTTP â”€â”€â”€â–¶â”‚  Streamlit App   â”‚              â”‚
â”‚  â”‚            â”‚              â”‚    (app.py)      â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                      â”‚                          â”‚
â”‚                                      â–¼                          â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚                          â”‚  Authentication   â”‚                 â”‚
â”‚                          â”‚  Check (Session)  â”‚                 â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                 â”‚      â”‚                        â”‚
â”‚                      Not Auth   â”‚      â”‚   Authenticated        â”‚
â”‚                                 â–¼      â–¼                        â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚                    â”‚     Login Page              â”‚             â”‚
â”‚                    â”‚  (login.py component)       â”‚             â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                 â”‚                               â”‚
â”‚                                 â”‚ Credentials                   â”‚
â”‚                                 â–¼                               â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚                    â”‚   Database.authenticate()   â”‚             â”‚
â”‚                    â”‚   (SHA-256 password check)  â”‚             â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                            â”‚           â”‚                        â”‚
â”‚                      Failed â”‚           â”‚ Success               â”‚
â”‚                            â”‚           â”‚                        â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚                    â”‚ Error Messageâ”‚  Session Saveâ”‚             â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                            â”‚                    â”‚
â”‚                                            â–¼                    â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚                              â”‚   Role Check         â”‚           â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                 â”‚              â”‚                â”‚
â”‚                          Admin  â”‚              â”‚  User          â”‚
â”‚                                 â–¼              â–¼                â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚                    â”‚ Admin Dashboardâ”‚  â”‚User Dashboard â”‚         â”‚
â”‚                    â”‚                â”‚  â”‚              â”‚         â”‚
â”‚                    â”‚ â€¢ Users Mgmt  â”‚  â”‚ â€¢ View Agentsâ”‚         â”‚
â”‚                    â”‚ â€¢ Agents Mgmt â”‚  â”‚ â€¢ Audit Logs â”‚         â”‚
â”‚                    â”‚ â€¢ Full Access â”‚  â”‚ â€¢ Settings   â”‚         â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Login Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        User Journey                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    START
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Open Application â”‚
â”‚ (localhost:8501) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check Session    â”‚â—€â”€â”€â”€â”€â”€â”
â”‚ Authenticated?   â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
      â”‚        â”‚           â”‚
      â”‚ NO     â”‚ YES       â”‚
      â”‚        â”‚           â”‚
      â–¼        â–¼           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  Login Screen    â”‚      â”‚
â”‚                  â”‚      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚      â”‚
â”‚ â”‚Select Role:  â”‚ â”‚      â”‚
â”‚ â”‚ âšª User      â”‚ â”‚      â”‚
â”‚ â”‚ âšª Admin     â”‚ â”‚      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚      â”‚
â”‚                  â”‚      â”‚
â”‚ Username: ______ â”‚      â”‚
â”‚ Password: ______ â”‚      â”‚
â”‚                  â”‚      â”‚
â”‚   [  LOGIN  ]    â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
      â”‚                   â”‚
      â–¼                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ Validate         â”‚      â”‚
â”‚ Credentials      â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
      â”‚        â”‚           â”‚
   Valid?   Invalid        â”‚
      â”‚        â”‚           â”‚
      â–¼        â–¼           â”‚
   YES    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
      â”‚   â”‚  Error!  â”‚     â”‚
      â”‚   â”‚Try Again â”‚â”€â”€â”€â”€â”€â”˜
      â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check Role       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚        â”‚
  Admin      User
      â”‚        â”‚
      â–¼        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Admin   â”‚  â”‚  User   â”‚
â”‚Dashboardâ”‚  â”‚Dashboardâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚            â”‚
      â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Navigation Menu:    â”‚
â”‚                      â”‚
â”‚ Admin:               â”‚
â”‚  â€¢ Home              â”‚
â”‚  â€¢ ğŸ‘¥ Users         â”‚
â”‚  â€¢ ğŸ¤– Agents        â”‚
â”‚  â€¢ Register Agent    â”‚
â”‚  â€¢ Audit Log         â”‚
â”‚  â€¢ Settings          â”‚
â”‚                      â”‚
â”‚ User:                â”‚
â”‚  â€¢ Home              â”‚
â”‚  â€¢ Select Agent      â”‚
â”‚  â€¢ Audit Log         â”‚
â”‚  â€¢ Settings          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Database Schema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SQLite Database                          â”‚
â”‚                  (data/agentic_iam.db)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   USERS TABLE       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)            â”‚
â”‚ username (UNIQUE)  â”‚
â”‚ password (SHA256)  â”‚
â”‚ role               â”‚â”€â”€â”€â”€ 'admin' or 'user'
â”‚ full_name          â”‚
â”‚ email              â”‚
â”‚ created_at         â”‚
â”‚ last_login         â”‚
â”‚ status             â”‚â”€â”€â”€â”€ 'active', 'inactive', 'suspended'
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AGENTS TABLE       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)            â”‚
â”‚ name               â”‚
â”‚ type               â”‚
â”‚ status             â”‚
â”‚ created_at         â”‚
â”‚ updated_at         â”‚
â”‚ metadata (JSON)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SESSIONS TABLE     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)            â”‚
â”‚ agent_id (FK)      â”‚â”€â”€â”€â”€ References AGENTS(id)
â”‚ started_at         â”‚
â”‚ ended_at           â”‚
â”‚ status             â”‚
â”‚ metadata (JSON)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EVENTS TABLE       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)            â”‚
â”‚ event_type         â”‚
â”‚ agent_id (FK)      â”‚â”€â”€â”€â”€ References AGENTS(id)
â”‚ action             â”‚
â”‚ details            â”‚
â”‚ created_at         â”‚
â”‚ status             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Structure

```
Agentic-IAM-main/
â”‚
â”œâ”€â”€ app.py                          â† Main application entry
â”‚   â”œâ”€â”€ initialize_session()        â† Setup session state
â”‚   â”œâ”€â”€ main()                      â† Route based on auth status
â”‚   â”œâ”€â”€ show_home()                 â† Dashboard home
â”‚   â”œâ”€â”€ show_admin_features()       â† Admin-only features
â”‚   â”œâ”€â”€ show_user_features()        â† User features
â”‚   â”œâ”€â”€ show_audit_log()            â† Audit logs
â”‚   â””â”€â”€ show_settings()             â† User settings
â”‚
â”œâ”€â”€ database.py                     â† Database operations
â”‚   â”œâ”€â”€ authenticate_user()         â† Login validation
â”‚   â”œâ”€â”€ create_user()               â† User creation
â”‚   â”œâ”€â”€ list_users()                â† Get all users
â”‚   â”œâ”€â”€ update_user_status()        â† Enable/disable users
â”‚   â”œâ”€â”€ change_password()           â† Password management
â”‚   â””â”€â”€ _hash_password()            â† SHA-256 hashing
â”‚
â””â”€â”€ dashboard/
    â””â”€â”€ components/
        â”œâ”€â”€ login.py                â† Login interface
        â”‚   â”œâ”€â”€ show_login_page()   â† Login form
        â”‚   â”œâ”€â”€ is_authenticated()  â† Check auth status
        â”‚   â”œâ”€â”€ is_admin()          â† Check admin role
        â”‚   â”œâ”€â”€ get_current_user()  â† Get user info
        â”‚   â”œâ”€â”€ logout()            â† Logout handler
        â”‚   â””â”€â”€ show_user_profile() â† Profile sidebar
        â”‚
        â”œâ”€â”€ user_management.py      â† User admin interface
        â”‚   â”œâ”€â”€ show_user_management() â† Main interface
        â”‚   â”œâ”€â”€ show_users_list()      â† List all users
        â”‚   â”œâ”€â”€ show_create_user_form()â† Create new user
        â”‚   â””â”€â”€ show_manage_users()    â† Edit users
        â”‚
        â””â”€â”€ agent_management.py     â† Agent operations
            â””â”€â”€ show_agent_management() â† Agent interface
```

## Security Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Security Measures                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Password Storage
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   User Password â†’ SHA-256 Hash â†’ Store in Database
   
   Example:
   "admin123" â†’ hash â†’ "240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9"

2. Authentication
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Login Attempt â†’ Retrieve User â†’ Hash Input Password â†’ Compare Hashes
   
   If Match: Create Session
   If No Match: Reject Login

3. Authorization
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Page Request â†’ Check Session â†’ Check Role â†’ Allow/Deny
   
   Admin Pages: Require role = 'admin'
   User Pages: Require role = 'user' OR 'admin'

4. Session Management
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Login Success â†’ Store in st.session_state:
   {
     'authenticated': True,
     'current_user': {
       'id': 1,
       'username': 'admin',
       'role': 'admin',
       'full_name': 'System Administrator',
       'email': 'admin@example.com'
     }
   }
   
   Logout â†’ Clear session_state â†’ Redirect to Login
```

## API Integration (Future)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              REST API Endpoints (Planned)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

POST   /api/v1/auth/login          â† User login
POST   /api/v1/auth/logout         â† User logout
GET    /api/v1/auth/session        â† Check session

GET    /api/v1/users               â† List users (admin)
POST   /api/v1/users               â† Create user (admin)
GET    /api/v1/users/:id           â† Get user details (admin)
PUT    /api/v1/users/:id           â† Update user (admin)
DELETE /api/v1/users/:id           â† Delete user (admin)

GET    /api/v1/agents              â† List agents
POST   /api/v1/agents              â† Create agent (admin)
GET    /api/v1/agents/:id          â† Get agent details
PUT    /api/v1/agents/:id          â† Update agent (admin)
DELETE /api/v1/agents/:id          â† Delete agent (admin)

GET    /api/v1/audit               â† Audit logs
GET    /api/v1/audit/:id           â† Specific audit entry
```
